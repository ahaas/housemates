<!-- Andre Haas -->

<% provide(:title, 'Calendar') %>

<h1>Calendar</h1>

<div class="row">
  <div class="col-md-12">
    <div id="calendar"></div>
  </div>
</div>

<div class="row top-buffer">
  <div class="col-md-12">
    <%= link_to "Add Event", events_new_url, class: 'btn btn-primary' %>
  </div>
</div>

<script>
  $(document).ready(function() {
    $('#calendar').fullCalendar({
      height: 'auto',
      editable: true,
      header: {right: 'today month,agendaWeek prev,next'},
      events: [
        <% current_user.household.events.each do |event| %>
          {
            id: '<%= event.id %>',
            title: '<%= event.name %>',
            start: '<%= event.start_at.iso8601 %>',
            end: '<%= event.end_at.iso8601 %>'
          },
        <% end %>
      ],
      eventClick: function(event, jsEvent, view) {
        window.location.replace('<%= events_edit_path %>?id=' + event.id);
      },
      dayClick: function(day, jsEvent, view) {
        window.location.replace('<%= events_new_path %>?datetime=' + day.format());
      }
    })
  });
</script>
